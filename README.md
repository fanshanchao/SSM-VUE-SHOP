# 零配置SSM+VUE前后端分离网上商城
[前端代码地址]()
## 项目介绍
前后端分离的网上商城。实现了普通商城拥有的主要功能，并且利用shiro实现了后台权限管理，可以修改用户权限，修改用户角色。并且只有非商城会有的权限才可以进入后台管理页面。并且整个项目使用rest风格来获取数据。[项目演示地址](http://120.76.56.254:8084/#/)
## 项目所用技术
### 后端
1. **SSM**：并且使用配置类无xml。
2. **shiro**：shiro完成了登陆验证以及用户权限管理部分。
3. **elasticsearch**：简单的使用了elasticsearch完成了搜索商品功能，但是权限安全方面还没有配置（xpath貌似要钱加上麻烦），无需登陆就可以访问修改里面的数据。所以各位大佬放过它。
4. **mysql**
5. **redis**：shiro的会话缓存和权限缓存用到了redis，以及注册时的邮箱验证码也暂存在了redis中
### 前端
1. **vue全集桶**
2. **饿了吗开发的element框架**

## 项目所有模块简介

### 登陆注册模块（主要是shiro的问题）
#### 登陆
1. 先解决跨域问题，使用的是后端允许所有跨域请求，前端不用做任何配置。
2. 后端使用shiro保存登陆信息，后端设置登陆信息保存时间为30分钟，超时后需要重新登陆，并且登陆的信息缓存在redis中，配置好了shiro从redis中获取用户登陆信息缓存。shiro使用redis做缓存是使用了一个shiro-redis的[开源插件](https://github.com/alexxiyang/shiro-redis),使用这个插件只需要在shiro中配置redis的相关配置，至于访问redis那些操作就不用你做了。
3. 登陆成功后后端将返回一个sessionId给前端，前端每次访问api都在请求头携带这个sessionId，后端每次通过shiro来验证这个sessionId是否登陆。这里要重写shiro的会话管理器，因为shiro默认是从cookie中获取sessionId，需要改写成从请求头中获取这个sessionId。
4. 解决登陆后的另一个跨域问题：由于跨域请求会发送跨域请求，而跨域请求是复杂请求，会在请求先发送一个position请求然后再发送实际的post，get请求，而前面这次的position请求并不带shiro的Authorization字段（也就是保存了sessionId的请求头），所以会导致认证失败，所以即使你登陆了也访问不要需要登陆才可以访问的接口。**解决方法**:重写shiro的认证过滤器，只要是position请求都允许它通过。
5. 登出也需要解决上面的跨域问题，所以也要重写shiro的登出过滤器。
6. 由于shiro只能拦截指定url而不能细分到请求，所以需要重写shiro的工厂bean，然后使用自定义的url匹配规则，例如orders==get就代表了对order的get请求 从而实现rest风格匹配。具体重写方式可以看[这篇博客](https://segmentfault.com/a/1190000014545172)。
7. 虽然页面上有下次自动登陆和忘记密码功能，但是这两个功能是没有实现的。下次自动登陆感觉不是很有必要，也不是很安全就没有实现。忘记密码就纯粹是懒得写了...
#### 注册
1. 注册是使用邮件注册的，邮箱验证码通过javamail发送的。这里要注意部署到linux javamail后不能使用25端口，要改成465端口。
2. 验证码暂存在redis中，并且设置验证码2分钟后在redis中失效。
3. 密码是利用shiro工具加密后再存在shiro中的，存的是加密后的数据不是明文。
4. 登陆和注册的数据校验都只在前端实现了，这里还需要改进。一般来说都是前端和后端都需要进行数据校验。

### 后台管理模块
后台管理又分为**用户管理**，**商品管理**，**订单管理**三个模块。由于后台管理涉及到权限问题，所以后台管理最重要的就是权限管理这块。我这个项目是前后端都做了权限管理，前端根据后端返回的权限信息动态的生成路由和按钮。后端使用shiro做了权限管理，权限管理用的5张mysql表如下：
![Image text](https://raw.github.com/yourName/repositpry/master/yourprojectName/img-folder/test.jpg)
